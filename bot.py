import os
import logging
from telegram import Update
from telegram.ext import Application, MessageHandler, filters, ContextTypes, CommandHandler
import requests
from dotenv import load_dotenv

load_dotenv()

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

BOT_TOKEN = os.getenv("BOT_TOKEN")
DEEPSEEK_API_KEY = os.getenv("DEEPSEEK_API_KEY")

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç-–Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥. –ù–∞–ø–∏—à–∏—Ç–µ '–º–µ–Ω—é' –¥–ª—è –ø—Ä–æ–±–Ω–æ–≥–æ –¥–Ω—è.")

async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        user_message = update.message.text
        
        if "–º–µ–Ω—é" in user_message.lower():
            menu_text = """
üçΩÔ∏è –ü–†–û–ë–ù–û–ï –ú–ï–ù–Æ –ù–ê –î–ï–ù–¨:

–ó–ê–í–¢–†–ê–ö: –ë–µ–ª–∫–æ–≤—ã–π –æ–º–ª–µ—Ç
‚Ä¢ 2 —è–π—Ü–∞ + 100–≥ —Ç–≤–æ—Ä–æ–≥–∞ + –æ–≤–æ—â–∏
‚Ä¢ –ö–ë–ñ–£: 320 –∫–∫–∞–ª ‚Ä¢ –ë: 28–≥ ‚Ä¢ –ñ: 18–≥ ‚Ä¢ –£: 12–≥

–û–ë–ï–î: –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ —Å –≥—Ä–µ—á–∫–æ–π  
‚Ä¢ 150–≥ –∫—É—Ä–∏—Ü—ã + 100–≥ –≥—Ä–µ—á–∫–∏ + —Å–∞–ª–∞—Ç
‚Ä¢ –ö–ë–ñ–£: 450 –∫–∫–∞–ª ‚Ä¢ –ë: 35–≥ ‚Ä¢ –ñ: 12–≥ ‚Ä¢ –£: 45–≥

–£–ñ–ò–ù: –†—ã–±–∞ –Ω–∞ –ø–∞—Ä—É —Å –æ–≤–æ—â–∞–º–∏
‚Ä¢ 200–≥ —Ç—Ä–µ—Å–∫–∏ + –±—Ä–æ–∫–∫–æ–ª–∏ + –º–æ—Ä–∫–æ–≤—å
‚Ä¢ –ö–ë–ñ–£: 280 –∫–∫–∞–ª ‚Ä¢ –ë: 25–≥ ‚Ä¢ –ñ: 8–≥ ‚Ä¢ –£: 20–≥
"""
            await update.message.reply_text(menu_text)
            return
            
        await update.message.reply_text("–ü–æ–∫–∞ —è —É–º–µ—é —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–µ–Ω—é. –ù–∞–ø–∏—à–∏—Ç–µ '–º–µ–Ω—é'")
            
    except Exception as e:
        logger.error(f"Error: {e}")
        await update.message.reply_text("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞")

def main():
    application = Application.builder().token(BOT_TOKEN).build()
    application.add_handler(CommandHandler("start", start))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    application.run_polling()

if __name__ == "__main__":
    main()
